{"version":3,"sources":["webpack://PL_API/webpack/bootstrap","webpack://PL_API/./src/auth.js","webpack://PL_API/./src/main.js"],"names":["Auth","events","start","callback","msg_error","connect","disconnect","finish","primary_url","auth_id","FindAuthToken","response","token","localStorage","getItem","atob","SetAuthToken","setItem","btoa","UnsetAuthToken","removeItem","parseJwt","base64Url","split","base64","decodeURIComponent","map","c","charCodeAt","toString","slice","join","JSON","parse","DoPOST","url","data","fetch","method","mode","headers","Headers","cache","body","stringify","then","json","err","console","error","SendMsg","msg","log","execEventOnGo","eventName","eventOnGoTree","execEvent","paramsSend","callbackTmp","window","PlConnectApiInstance","event","callbackEvent","eventsOnGo","EventTrigger","auth","user","password","require","module","exports"],"mappings":"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","file":"pl_api.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/main.js\");\n","export default class Auth {\n\n    constructor() {\n\n        //Default events\n        this.events = {\n            start: {\n                callback: () => {},\n                msg_error: \"Event -> start callback is not function\"\n            },\n            connect: {\n                callback: () => {},\n                msg_error: \"Event -> connect callback is not function\"\n            },\n            disconnect: {\n                callback: () => {},\n                msg_error: \"Event -> disconnect callback is not function\"\n            },\n            finish: {\n                callback: () => {},\n                msg_error: \"Event -> finish callback is not function\"\n            }\n        };\n        this.primary_url = \"https://foservices.prensalibre.com\";\n        this.auth_id = \"0f07e8e38a7b56f90912b3d0d874f7e7\";\n\n        this.FindAuthToken = () => {\n            let response = false;\n            const token = localStorage.getItem(this.auth_id);\n            if (token !== null) {\n                response = atob(token);\n            }\n            return response;\n        };\n\n        this.SetAuthToken = (token) => {\n            localStorage.setItem(this.auth_id, btoa(token));\n        };\n\n        this.UnsetAuthToken = () => {\n            localStorage.removeItem(this.auth_id);\n            return !this.FindAuthToken();\n        };\n\n        this.parseJwt = (token) => {\n            if (token) {\n                var base64Url = token.split('.')[1];\n                var base64 = decodeURIComponent(atob(base64Url).split('').map(function (c) {\n                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n                }).join(''));\n\n                return JSON.parse(base64);\n            }\n            else{\n                return false;\n            }\n        };\n\n        this.DoPOST = (url, data, callback) => {\n\n            fetch(url, {\n                method: 'POST',\n                mode: 'cors',\n                headers: new Headers(\n                  {\n                      'Content-Type': 'application/json'\n                  }),\n                cache: 'no-cache',\n                body: JSON.stringify(data)\n            })\n              .then((response) => {\n                  return response.json();\n              })\n              .then((response) => {\n                  callback(response);\n              })\n              .catch((err) => {\n                  console.error(err);\n              });\n        };\n\n        this.SendMsg = (msg) => {\n            console.log(msg);\n        };\n\n        this.execEventOnGo = (eventName, eventOnGoTree) => {\n            if(typeof eventOnGoTree[eventName] !== \"undefined\") {\n                const token = this.FindAuthToken();\n                eventOnGoTree[eventName](this.parseJwt(token));\n            }\n        };\n\n        this.execEvent = (eventName, paramsSend) => {\n            // If the event exists\n            if (typeof this.events[eventName] !== \"undefined\") {\n\n                // If the callback exists\n                if (typeof this.events[eventName].callback === \"function\") {\n                    // Call event\n                    const callbackTmp = this.events[eventName].callback;\n                    callbackTmp(paramsSend);\n                }\n                else {\n                    this.SendMsg(this.events[eventName].msg_error);\n                }\n            }\n            else{\n                this.SendMsg(\"The event '\"+eventName+\"' not exists\");\n            }\n        };\n\n        // Singleton in window\n        if (window.PlConnectApiInstance) {\n            return window.PlConnectApiInstance;\n        }\n        window.PlConnectApiInstance = this;\n    }\n\n    Event(event, callbackEvent) {\n\n        if (typeof this.events[event] !== \"undefined\") {\n            this.events[event].callback = callbackEvent;\n        }\n        else{\n            console.log(\"Event '\"+event+\"' is not defined\");\n        }\n    }\n\n    EventTrigger(event) {\n        const token = this.FindAuthToken();\n        this.execEvent(event, this.parseJwt(token));\n    }\n\n    CheckLogin(eventsOnGo) {\n\n        if (!eventsOnGo) eventsOnGo = {};\n\n        // Exec start callback\n        this.EventTrigger(\"start\");\n        this.execEventOnGo(\"start\", eventsOnGo);\n\n        // Check token\n        const token = this.FindAuthToken();\n\n        // If token exists\n        if (token) {\n            this.DoPOST(this.primary_url + '/auth/check', {token: token}, (data) => {\n\n                if (typeof data.auth !== \"undefined\") {\n                    if (data.auth === 1) {\n                        this.SendMsg(\"** User connected **\");\n                        this.EventTrigger(\"connect\");\n                        this.execEventOnGo(\"connect\", eventsOnGo);\n                    }\n                    else {\n                        this.EventTrigger(\"disconnect\");\n                        this.execEventOnGo(\"disconnect\", eventsOnGo);\n                    }\n                }\n                // Call on_finish_validation\n                this.EventTrigger(\"finish\");\n                this.execEventOnGo(\"finish\", eventsOnGo);\n            });\n        }\n        else {\n            // Call on disconnect\n            this.EventTrigger(\"disconnect\");\n            this.execEventOnGo(\"disconnect\", eventsOnGo);\n\n            // Call on_finish_validation\n            this.EventTrigger(\"finish\");\n            this.execEventOnGo(\"finish\", eventsOnGo);\n        }\n    };\n\n    MakeLogin(user, password, eventsOnGo) {\n\n        if(!eventsOnGo) eventsOnGo = {};\n\n        this.EventTrigger(\"start\");\n        this.execEventOnGo(\"start\", eventsOnGo);\n\n        this.DoPOST(this.primary_url + '/auth/login', {user: user, password: password}, (data) => {\n\n            if (typeof data.auth !== \"undefined\") {\n                if (data.auth === 1) {\n                    this.SetAuthToken(data.token);\n                    this.EventTrigger(\"connect\");\n                    this.execEventOnGo(\"connect\", eventsOnGo);\n                }\n                else {\n                    this.EventTrigger(\"disconnect\");\n                    this.execEventOnGo(\"disconnect\", eventsOnGo);\n                }\n            }\n            this.EventTrigger(\"finish\");\n            this.execEventOnGo(\"finish\", eventsOnGo);\n        });\n    }\n\n    MakeLogout() {\n        return this.UnsetAuthToken();\n    }\n\n    MakeRegister() {\n\n    }\n}","const Auth = require('./auth').default;\r\nmodule.exports = {\r\n  Auth: Auth\r\n};"],"sourceRoot":""}